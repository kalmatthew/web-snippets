# Micro Editor

"Heavily inspired" by [TinyEditor](https://github.com/umpox/TinyEditor)

## Example Pages

- [Click-the-box game][1]
- [Dungeons & Dragons name generator][2]


[1]: data:text/html;charset=utf-8,%3Chtml%3E%3Chead%3E%0A%20%20%3Ctitle%3E~%3C/title%3E%0A%20%20%3Cmeta%20http-equiv=%22Content-Type%22%20content=%22text/html;%20charset=utf-8%22%3E%0A%20%20%3Cstyle%3E%0A%20%20%20%20html%20%7B%0A%20%20%20%20%20%20background:%20%23000;%0A%20%20%20%20%7D%0A%0A%20%20%20%20textarea,%20input%20%7B%0A%20%20%20%20%20%20background:%20%23224;%0A%20%20%20%20%20%20border:%200;%0A%20%20%20%20%20%20color:%20%23fff;%0A%20%20%20%20%7D%0A%0A%20%20%20%20iframe%20%7B%0A%20%20%20%20%20%20background:%20%23fff;%0A%20%20%20%20%7D%0A%0A%20%20%20%20textarea,%20iframe%20%7B%0A%20%20%20%20%20%20width:%2040%25;%0A%20%20%20%20%20%20height:%2042%25;%0A%20%20%20%20%20%20margin:%200.5%25%201%25;%0A%20%20%20%20%20%20resize:%20none;%0A%20%20%20%20%7D%0A%0A%20%20%20%20input%20%7B%0A%20%20%20%20%20%20width:%2084%25;%0A%20%20%20%20%20%20margin-bottom:%200.5%25;%0A%20%20%20%20%7D%0A%20%20%3C/style%3E%0A%3C/head%3E%0A%3Cbody%3E%0A%20%20%3Cdiv%3E%0A%20%20%20%20%3Cinput%20id=%22encoded%22%3E%0A%20%20%20%20%3Cinput%20id=%22isrc%22%3E%0A%20%20%3C/div%3E%0A%20%20%3Ctextarea%20id=%22html%22%3E%3C/textarea%3E%0A%20%20%3Ctextarea%20id=%22css%22%3E%3C/textarea%3E%0A%20%20%3Ctextarea%20id=%22js%22%3E%3C/textarea%3E%0A%20%20%3Ciframe%20id=%22iframe%22%20srcdoc=%22%3Cdiv%20id=&quot;ping&quot;%3E%3C/div%3E%0A%3Ch1%20id=&quot;msg&quot;%3EYou%20win%3Cbr%3EReplay?%3C/h1%3E%3Cstyle%3E%23ping%20%7B%0A%20%20height:%2020%25;%0A%20%20width:%2020%25;%0A%20%20background:%20orange;%0A%20%20position:%20absolute;%0A%20%20display:%20inline-block;%0A%7D%0A%0A%23ping.win%20%7B%0A%20%20display:%20none;%0A%7D%0A%0A%23msg%20%7B%0A%20%20position:%20absolute;%0A%20%20color:%20white;%0A%20%20padding-left:%2040%25;%0A%20%20padding-top:%2010%25;%0A%20%20display:%20none;%0A%7D%0A%0A%23msg.win%20%7B%0A%20%20display:%20block;%0A%7D%0A%0Ahtml,%20body%20%7B%0A%20%20height:%20100%25;%0A%20%20margin:%200;%0A%20%20background:%20%23002;%0A%20%20overflow:%20hidden;%0A%7D%0A%3C/style%3E%3Cscript%3E(()%20=%3E%20%7B%0A%20%20const%20state%20=%20%7B%0A%20%20%20%20time:%200%0A%20%20%7D%0A%0A%20%20const%20win%20=%20()%20=%3E%20%7B%0A%20%20%20%20ping.className%20=%20&quot;win&quot;;%0A%20%20%20%20msg.className%20=%20&quot;win&quot;;%0A%20%20%7D%0A%0A%20%20const%20restart%20=%20()%20=%3E%20%7B%0A%20%20%20%20msg.className%20=%20&quot;&quot;;%0A%20%20%20%20ping.className%20=%20&quot;&quot;;%0A%20%20%7D%0A%0A%20%20ping.touchstart%20=%20win;%0A%20%20ping.onclick%20=%20win;%0A%20%20msg.touchstart%20=%20restart;%0A%20%20msg.onclick%20=%20restart;%0A%0A%20%20setInterval(()%20=%3E%20%7B%0A%20%20%20%20state.time%20=%20state.time%20+%200.005;%0A%20%20%20%20ping.style.top%20=%20(45%20*%20(1%20+%20Math.sin(3%20*%20state.time)))%20+%20&quot;%25&quot;;%0A%20%20%20%20ping.style.left%20=%20(45%20*%20(1%20+%20Math.sin(7%20*%20state.time)))%20+%20&quot;%25&quot;;%0A%20%20%7D,%2020)%0A%7D)()%3C/script%3E%22%3E%3C/iframe%3E%0A%20%20%3Cscript%3E%0A%20%20%20%20location.hash.replace(/%5E%23/,%20'').split('-')%0A%20%20%20%20%20%20.map(part%20=%3E%20atob(part))%0A%20%20%20%20%20%20.forEach((part,%20index)%20=%3E%20%7B%0A%20%20%20%20%20%20%20%20if%20(index%20===%200)%20html.value%20=%20part;%0A%20%20%20%20%20%20%20%20if%20(index%20===%201)%20css.value%20=%20part;%0A%20%20%20%20%20%20%20%20if%20(index%20===%202)%20js.value%20=%20part;%0A%20%20%20%20%20%20%7D);%0A%0A%20%20%20%20const%20update%20=%20()%20=%3E%20%7B%0A%20%20%20%20%20%20const%20src%20=%20html.value%20+%20'%3Cstyle%3E'%20+%20css.value%20+%20'%3C%5C/style%3E%3Cscript%3E'%20+%20js.value%20+%20'%3C%5C/script%3E';%0A%20%20%20%20%20%20iframe.srcdoc%20=%20src;%0A%20%20%20%20%20%20isrc.value%20=%20%22%3Ciframe%20src=%5C%22data:text/html;charset=utf-8,%22%20+%20encodeURI(src).replace(/%23/g,%20'%2523')%20+%20%22%5C%22%20/%3E%22;%0A%0A%20%20%20%20%20%20const%20hash%20=%20btoa(html.value)%20+%20'-'%20+%20btoa(css.value)%20+%20'-'%20+%20btoa(js.value);%0A%0A%20%20%20%20%20%20location.hash%20=%20hash;%0A%20%20%20%20%20%20encoded.value%20=%20%22data:text/html;charset=utf-8,%22%20+%0A%20%20%20%20%20%20%20%20encodeURI(document.children%5B0%5D.outerHTML).replace(/%23/g,%20'%2523')%20+%0A%20%20%20%20%20%20%20%20%22%23%22%20+%20hash;%0A%20%20%20%20%7D%0A%0A%20%20%20%20document.onchange%20=%20update;%0A%20%20%20%20update();%0A%20%20%3C/script%3E%0A%0A%0A%3C/body%3E%3C/html%3E#PGRpdiBpZD0icGluZyI+PC9kaXY+CjxoMSBpZD0ibXNnIj5Zb3Ugd2luPGJyPlJlcGxheT88L2gxPg==-I3BpbmcgewogIGhlaWdodDogMjAlOwogIHdpZHRoOiAyMCU7CiAgYmFja2dyb3VuZDogb3JhbmdlOwogIHBvc2l0aW9uOiBhYnNvbHV0ZTsKICBkaXNwbGF5OiBpbmxpbmUtYmxvY2s7Cn0KCiNwaW5nLndpbiB7CiAgZGlzcGxheTogbm9uZTsKfQoKI21zZyB7CiAgcG9zaXRpb246IGFic29sdXRlOwogIGNvbG9yOiB3aGl0ZTsKICBwYWRkaW5nLWxlZnQ6IDQwJTsKICBwYWRkaW5nLXRvcDogMTAlOwogIGRpc3BsYXk6IG5vbmU7Cn0KCiNtc2cud2luIHsKICBkaXNwbGF5OiBibG9jazsKfQoKaHRtbCwgYm9keSB7CiAgaGVpZ2h0OiAxMDAlOwogIG1hcmdpbjogMDsKICBiYWNrZ3JvdW5kOiAjMDAyOwogIG92ZXJmbG93OiBoaWRkZW47Cn0K-KCgpID0+IHsKICBjb25zdCBzdGF0ZSA9IHsKICAgIHRpbWU6IDAKICB9CgogIGNvbnN0IHdpbiA9ICgpID0+IHsKICAgIHBpbmcuY2xhc3NOYW1lID0gIndpbiI7CiAgICBtc2cuY2xhc3NOYW1lID0gIndpbiI7CiAgfQoKICBjb25zdCByZXN0YXJ0ID0gKCkgPT4gewogICAgbXNnLmNsYXNzTmFtZSA9ICIiOwogICAgcGluZy5jbGFzc05hbWUgPSAiIjsKICB9CgogIHBpbmcudG91Y2hzdGFydCA9IHdpbjsKICBwaW5nLm9uY2xpY2sgPSB3aW47CiAgbXNnLnRvdWNoc3RhcnQgPSByZXN0YXJ0OwogIG1zZy5vbmNsaWNrID0gcmVzdGFydDsKCiAgc2V0SW50ZXJ2YWwoKCkgPT4gewogICAgc3RhdGUudGltZSA9IHN0YXRlLnRpbWUgKyAwLjAwNTsKICAgIHBpbmcuc3R5bGUudG9wID0gKDQ1ICogKDEgKyBNYXRoLnNpbigzICogc3RhdGUudGltZSkpKSArICIlIjsKICAgIHBpbmcuc3R5bGUubGVmdCA9ICg0NSAqICgxICsgTWF0aC5zaW4oNyAqIHN0YXRlLnRpbWUpKSkgKyAiJSI7CiAgfSwgMjApCn0pKCk=
[2]: data:text/html;charset=utf-8,%3Chtml%3E%3Chead%3E%0A%20%20%3Ctitle%3E~%3C/title%3E%0A%20%20%3Cmeta%20http-equiv=%22Content-Type%22%20content=%22text/html;%20charset=utf-8%22%3E%0A%20%20%3Cstyle%3E%0A%20%20%20%20html%20%7B%0A%20%20%20%20%20%20background:%20%23000;%0A%20%20%20%20%7D%0A%0A%20%20%20%20textarea,%20input%20%7B%0A%20%20%20%20%20%20background:%20%23224;%0A%20%20%20%20%20%20border:%200;%0A%20%20%20%20%20%20color:%20%23fff;%0A%20%20%20%20%7D%0A%0A%20%20%20%20iframe%20%7B%0A%20%20%20%20%20%20background:%20%23fff;%0A%20%20%20%20%7D%0A%0A%20%20%20%20textarea,%20iframe%20%7B%0A%20%20%20%20%20%20width:%2040%25;%0A%20%20%20%20%20%20height:%2042%25;%0A%20%20%20%20%20%20margin:%200.5%25%201%25;%0A%20%20%20%20%20%20resize:%20none;%0A%20%20%20%20%7D%0A%0A%20%20%20%20input%20%7B%0A%20%20%20%20%20%20width:%2084%25;%0A%20%20%20%20%20%20margin-bottom:%200.5%25;%0A%20%20%20%20%7D%0A%20%20%3C/style%3E%0A%3C/head%3E%0A%3Cbody%3E%0A%20%20%3Cdiv%3E%0A%20%20%20%20%3Cinput%20id=%22encoded%22%3E%0A%20%20%20%20%3Cinput%20id=%22isrc%22%3E%0A%20%20%3C/div%3E%0A%20%20%3Ctextarea%20id=%22html%22%20placeholder=%22HTML%22%3E%3C/textarea%3E%0A%20%20%3Ctextarea%20id=%22css%22%20placeholder=%22CSS%22%3E%3C/textarea%3E%0A%20%20%3Ctextarea%20id=%22js%22%20placeholder=%22JavaScript%22%3E%3C/textarea%3E%0A%20%20%3Ciframe%20id=%22iframe%22%20srcdoc=%22%3Cdiv%20id=&quot;app-root&quot;%3E%3C/div%3E%0A%3Cstyle%3E%23container%20%7B%0A%20%20background-color:%20%23EFEFEF;%0A%20%20layout:%20inline-block;%0A%20%20padding:%201em;%0A%7D%0A%0A%23container%20%3E%20*%20%7B%0A%20%20margin:%201em;%0A%7D%0A%0A%23name%20%7B%0A%20%20font-weight:%20bold;%0A%7D%3C/style%3E%3Cscript%3E(function()%20%7B%0A%20%20//%20Name%20data%20-%20Things%20put%20in%20here%20automagically%20turn%20up%20in%20the%20UI%0A%20%20const%20names%20=%20%7B%0A%20%20%20%20dwarf:%20%7B%0A%20%20%20%20%20%20female:%20%5B%0A%20%20%20%20%20%20%20%20&quot;Abmer&quot;,%0A%20%20%20%20%20%20%20%20&quot;Artin&quot;,%0A%20%20%20%20%20%20%20%20&quot;Audhild&quot;,%0A%20%20%20%20%20%20%20%20&quot;Bardryn&quot;,%0A%20%20%20%20%20%20%20%20&quot;Dagnal&quot;,%0A%20%20%20%20%20%20%20%20&quot;Diesa&quot;,%0A%20%20%20%20%20%20%20%20&quot;Eldeth&quot;,%0A%20%20%20%20%20%20%20%20&quot;Falkrunn&quot;,%0A%20%20%20%20%20%20%20%20&quot;Finellen&quot;,%0A%20%20%20%20%20%20%20%20&quot;Gunnloda&quot;,%0A%20%20%20%20%20%20%20%20&quot;Gurdis&quot;,%0A%20%20%20%20%20%20%20%20&quot;Helja&quot;,%0A%20%20%20%20%20%20%20%20&quot;Hlin&quot;,%0A%20%20%20%20%20%20%20%20&quot;Kathra&quot;,%0A%20%20%20%20%20%20%20%20&quot;Kristryd&quot;,%0A%20%20%20%20%20%20%20%20&quot;Ilde&quot;,%0A%20%20%20%20%20%20%20%20&quot;Liftrasa&quot;,%0A%20%20%20%20%20%20%20%20&quot;Mardred&quot;,%0A%20%20%20%20%20%20%20%20&quot;Riswynn&quot;,%0A%20%20%20%20%20%20%20%20&quot;Sannl&quot;,%0A%20%20%20%20%20%20%20%20&quot;Torbera&quot;,%0A%20%20%20%20%20%20%20%20&quot;Torgga&quot;,%0A%20%20%20%20%20%20%20%20&quot;Vistra&quot;%0A%20%20%20%20%20%20%5D,%0A%20%20%20%20%20%20male:%20%5B%0A%20%20%20%20%20%20%20%20&quot;Aldrik&quot;,%0A%20%20%20%20%20%20%20%20&quot;Alberich&quot;,%0A%20%20%20%20%20%20%20%20&quot;Baern&quot;,%0A%20%20%20%20%20%20%20%20&quot;Dain&quot;,%0A%20%20%20%20%20%20%20%20&quot;Darrak&quot;,%0A%20%20%20%20%20%20%20%20&quot;Delg&quot;,%0A%20%20%20%20%20%20%20%20&quot;Eberk&quot;,%0A%20%20%20%20%20%20%20%20&quot;Einkil&quot;,%0A%20%20%20%20%20%20%20%20&quot;Fargrim&quot;,%0A%20%20%20%20%20%20%20%20&quot;Flint&quot;,%0A%20%20%20%20%20%20%20%20&quot;Gardain&quot;,%0A%20%20%20%20%20%20%20%20&quot;Harbek&quot;,%0A%20%20%20%20%20%20%20%20&quot;Kildrak&quot;,%0A%20%20%20%20%20%20%20%20&quot;Morgran&quot;,%0A%20%20%20%20%20%20%20%20&quot;Orsik&quot;,%0A%20%20%20%20%20%20%20%20&quot;Oskar&quot;,%0A%20%20%20%20%20%20%20%20&quot;Rangrim&quot;,%0A%20%20%20%20%20%20%20%20&quot;Rurik&quot;,%0A%20%20%20%20%20%20%20%20&quot;Taklinn&quot;,%0A%20%20%20%20%20%20%20%20&quot;Thoradin&quot;,%0A%20%20%20%20%20%20%20%20&quot;Thorin&quot;,%0A%20%20%20%20%20%20%20%20&quot;Tordek&quot;,%0A%20%20%20%20%20%20%20%20&quot;Traubon&quot;,%0A%20%20%20%20%20%20%20%20&quot;Travok&quot;,%0A%20%20%20%20%20%20%20%20&quot;Ulfgar&quot;,%0A%20%20%20%20%20%20%20%20&quot;Veit&quot;,%0A%20%20%20%20%20%20%20%20&quot;Vondal&quot;%0A%20%20%20%20%20%20%5D,%0A%20%20%20%20%20%20family:%20%5B%0A%20%20%20%20%20%20%20%20&quot;Balderk&quot;,%0A%20%20%20%20%20%20%20%20&quot;Battlehammer&quot;,%0A%20%20%20%20%20%20%20%20&quot;Brawnanvil&quot;,%0A%20%20%20%20%20%20%20%20&quot;Dankil&quot;,%0A%20%20%20%20%20%20%20%20&quot;Fireforge&quot;,%0A%20%20%20%20%20%20%20%20&quot;Fristbeard&quot;,%0A%20%20%20%20%20%20%20%20&quot;Gorunn&quot;,%0A%20%20%20%20%20%20%20%20&quot;Holderhek&quot;,%0A%20%20%20%20%20%20%20%20&quot;Ironfist&quot;,%0A%20%20%20%20%20%20%20%20&quot;Loderr&quot;,%0A%20%20%20%20%20%20%20%20&quot;Lutgehr&quot;,%0A%20%20%20%20%20%20%20%20&quot;Rumnaheim&quot;,%0A%20%20%20%20%20%20%20%20&quot;Strakeln&quot;,%0A%20%20%20%20%20%20%20%20&quot;Torunn&quot;,%0A%20%20%20%20%20%20%20%20&quot;Ungart&quot;%0A%20%20%20%20%20%20%5D%0A%20%20%20%20%7D,%0A%20%20%20%20elf:%20%7B%0A%20%20%20%20%20%20female:%20%5B%0A%20%20%20%20%20%20%20%20&quot;Adrie&quot;,%0A%20%20%20%20%20%20%20%20&quot;Althea&quot;,%0A%20%20%20%20%20%20%20%20&quot;Anastrianna&quot;,%0A%20%20%20%20%20%20%20%20&quot;Andraste&quot;,%0A%20%20%20%20%20%20%20%20&quot;Antinua&quot;,%0A%20%20%20%20%20%20%20%20&quot;Bethrynna&quot;,%0A%20%20%20%20%20%20%20%20&quot;Birel&quot;,%0A%20%20%20%20%20%20%20%20&quot;Caelynn&quot;,%0A%20%20%20%20%20%20%20%20&quot;Drusilia&quot;,%0A%20%20%20%20%20%20%20%20&quot;Enna&quot;,%0A%20%20%20%20%20%20%20%20&quot;Felosial&quot;,%0A%20%20%20%20%20%20%20%20&quot;Ielenia&quot;,%0A%20%20%20%20%20%20%20%20&quot;Jelenneth&quot;,%0A%20%20%20%20%20%20%20%20&quot;Keyleth&quot;,%0A%20%20%20%20%20%20%20%20&quot;Leshanna&quot;,%0A%20%20%20%20%20%20%20%20&quot;Lia&quot;,%0A%20%20%20%20%20%20%20%20&quot;Meriele&quot;,%0A%20%20%20%20%20%20%20%20&quot;Mialee&quot;,%0A%20%20%20%20%20%20%20%20&quot;Naivara&quot;,%0A%20%20%20%20%20%20%20%20&quot;Quelenna&quot;,%0A%20%20%20%20%20%20%20%20&quot;Quillathe&quot;,%0A%20%20%20%20%20%20%20%20&quot;Sariel&quot;,%0A%20%20%20%20%20%20%20%20&quot;Shanairra&quot;,%0A%20%20%20%20%20%20%20%20&quot;Shava&quot;,%0A%20%20%20%20%20%20%20%20&quot;Silaqui&quot;,%0A%20%20%20%20%20%20%20%20&quot;Theirastra&quot;,%0A%20%20%20%20%20%20%20%20&quot;Thia&quot;,%0A%20%20%20%20%20%20%20%20&quot;Vadania&quot;,%0A%20%20%20%20%20%20%20%20&quot;Valanthe&quot;,%0A%20%20%20%20%20%20%20%20&quot;Xanaphia&quot;%0A%20%20%20%20%20%20%5D,%0A%20%20%20%20%20%20male:%20%5B%0A%20%20%20%20%20%20%20%20&quot;Adran&quot;,%0A%20%20%20%20%20%20%20%20&quot;Aelar&quot;,%0A%20%20%20%20%20%20%20%20&quot;Aramil&quot;,%0A%20%20%20%20%20%20%20%20&quot;Arannis&quot;,%0A%20%20%20%20%20%20%20%20&quot;Aust&quot;,%0A%20%20%20%20%20%20%20%20&quot;Beiro&quot;,%0A%20%20%20%20%20%20%20%20&quot;Berrian&quot;,%0A%20%20%20%20%20%20%20%20&quot;Carric&quot;,%0A%20%20%20%20%20%20%20%20&quot;Enialis&quot;,%0A%20%20%20%20%20%20%20%20&quot;Erdan&quot;,%0A%20%20%20%20%20%20%20%20&quot;Erevan&quot;,%0A%20%20%20%20%20%20%20%20&quot;Galinndan&quot;,%0A%20%20%20%20%20%20%20%20&quot;Hadarai&quot;,%0A%20%20%20%20%20%20%20%20&quot;Heian&quot;,%0A%20%20%20%20%20%20%20%20&quot;Himo&quot;,%0A%20%20%20%20%20%20%20%20&quot;Immeral&quot;,%0A%20%20%20%20%20%20%20%20&quot;Ivellios&quot;,%0A%20%20%20%20%20%20%20%20&quot;Laucian&quot;,%0A%20%20%20%20%20%20%20%20&quot;Mindartis&quot;,%0A%20%20%20%20%20%20%20%20&quot;Paelias&quot;,%0A%20%20%20%20%20%20%20%20&quot;Peren&quot;,%0A%20%20%20%20%20%20%20%20&quot;Quarion&quot;,%0A%20%20%20%20%20%20%20%20&quot;Riardon&quot;,%0A%20%20%20%20%20%20%20%20&quot;Rolen&quot;,%0A%20%20%20%20%20%20%20%20&quot;Soveliss&quot;,%0A%20%20%20%20%20%20%20%20&quot;Thamio&quot;,%0A%20%20%20%20%20%20%20%20&quot;Tharivol&quot;,%0A%20%20%20%20%20%20%20%20&quot;Theren&quot;,%0A%20%20%20%20%20%20%20%20&quot;Varis&quot;%0A%20%20%20%20%20%20%5D,%0A%20%20%20%20%20%20family:%20%5B%0A%20%20%20%20%20%20%20%20&quot;Amakiir%20(Gemflower)&quot;,%0A%20%20%20%20%20%20%20%20&quot;Amastacia%20(Starflower)&quot;,%0A%20%20%20%20%20%20%20%20&quot;Galanodel%20(Moonwhisper)&quot;,%0A%20%20%20%20%20%20%20%20&quot;Holimion%20(Diamonddew)&quot;,%0A%20%20%20%20%20%20%20%20&quot;Ilphelkiir%20(Gemblossom)&quot;,%0A%20%20%20%20%20%20%20%20&quot;Liadon%20(Silverfrond)&quot;,%0A%20%20%20%20%20%20%20%20&quot;Meliamne%20(Oakenheel)&quot;,%0A%20%20%20%20%20%20%20%20&quot;Na%C3%AFlo%20(Nightbreeze)&quot;,%0A%20%20%20%20%20%20%20%20&quot;Siannodel%20(Moonbrook)&quot;,%0A%20%20%20%20%20%20%20%20&quot;Xiloscient%20(Goldpetal)&quot;%0A%20%20%20%20%20%20%5D%0A%20%20%20%20%7D,%0A%20%20%20%20halfling:%20%7B%0A%20%20%20%20%20%20female:%20%5B%0A%20%20%20%20%20%20%20%20&quot;Andry&quot;,%0A%20%20%20%20%20%20%20%20&quot;Bree&quot;,%0A%20%20%20%20%20%20%20%20&quot;Callie&quot;,%0A%20%20%20%20%20%20%20%20&quot;Cora&quot;,%0A%20%20%20%20%20%20%20%20&quot;Euphemia&quot;,%0A%20%20%20%20%20%20%20%20&quot;Jillian&quot;,%0A%20%20%20%20%20%20%20%20&quot;Kithri&quot;,%0A%20%20%20%20%20%20%20%20&quot;Lavinia&quot;,%0A%20%20%20%20%20%20%20%20&quot;Lidda&quot;,%0A%20%20%20%20%20%20%20%20&quot;Merla&quot;,%0A%20%20%20%20%20%20%20%20&quot;Nedda&quot;,%0A%20%20%20%20%20%20%20%20&quot;Paela&quot;,%0A%20%20%20%20%20%20%20%20&quot;Portia&quot;,%0A%20%20%20%20%20%20%20%20&quot;Seraphina&quot;,%0A%20%20%20%20%20%20%20%20&quot;Shaena&quot;,%0A%20%20%20%20%20%20%20%20&quot;Trym&quot;,%0A%20%20%20%20%20%20%20%20&quot;Vani&quot;,%0A%20%20%20%20%20%20%20%20&quot;Verna&quot;%0A%20%20%20%20%20%20%5D,%0A%20%20%20%20%20%20male:%20%5B%0A%20%20%20%20%20%20%20%20&quot;Alton&quot;,%0A%20%20%20%20%20%20%20%20&quot;Ander&quot;,%0A%20%20%20%20%20%20%20%20&quot;Cade&quot;,%0A%20%20%20%20%20%20%20%20&quot;Corrin&quot;,%0A%20%20%20%20%20%20%20%20&quot;Eldon&quot;,%0A%20%20%20%20%20%20%20%20&quot;Errich&quot;,%0A%20%20%20%20%20%20%20%20&quot;Finnan&quot;,%0A%20%20%20%20%20%20%20%20&quot;Garret&quot;,%0A%20%20%20%20%20%20%20%20&quot;Lindal&quot;,%0A%20%20%20%20%20%20%20%20&quot;Lyle&quot;,%0A%20%20%20%20%20%20%20%20&quot;Merric&quot;,%0A%20%20%20%20%20%20%20%20&quot;Milo&quot;,%0A%20%20%20%20%20%20%20%20&quot;Osborn&quot;,%0A%20%20%20%20%20%20%20%20&quot;Perrin&quot;,%0A%20%20%20%20%20%20%20%20&quot;Reed&quot;,%0A%20%20%20%20%20%20%20%20&quot;ROscoe&quot;,%0A%20%20%20%20%20%20%20%20&quot;Wellby&quot;%0A%20%20%20%20%20%20%5D,%0A%20%20%20%20%20%20family:%20%5B%0A%20%20%20%20%20%20%20%20&quot;Brushgather&quot;,%0A%20%20%20%20%20%20%20%20&quot;Goodbarrel&quot;,%0A%20%20%20%20%20%20%20%20&quot;Greenbottle&quot;,%0A%20%20%20%20%20%20%20%20&quot;High-hill&quot;,%0A%20%20%20%20%20%20%20%20&quot;Hilltopple&quot;,%0A%20%20%20%20%20%20%20%20&quot;Leagallow&quot;,%0A%20%20%20%20%20%20%20%20&quot;Tealeaf&quot;,%0A%20%20%20%20%20%20%20%20&quot;Thorngage&quot;,%0A%20%20%20%20%20%20%20%20&quot;Tosscobble&quot;,%0A%20%20%20%20%20%20%20%20&quot;Underbough&quot;%0A%20%20%20%20%20%20%5D%0A%20%20%20%20%7D%0A%20%20%7D;%0A%0A%20%20/*%0A%20%20%20*%20General%20utilities%0A%20%20%20*/%0A%0A%20%20//%20Item%20from%20array%0A%20%20const%20choose%20=%20list%20=%3E%20list%5BMath.floor(Math.random()%20*%20list.length)%5D;%0A%0A%20%20//%20Capitalise%20a%20word%0A%20%20const%20capitalise%20=%20text%20=%3E%0A%20%20%20%20text.substr(0,%201).toLocaleUpperCase()%20+%20text.substr(1).toLocaleLowerCase();%0A%0A%20%20//%20Element%20creation%20helper%0A%20%20const%20el%20=%20(tag,%20attrs,%20children)%20=%3E%20%7B%0A%20%20%20%20const%20thisEl%20=%20document.createElement(tag);%0A%0A%20%20%20%20Object.keys(attrs)%0A%20%20%20%20%20%20//%20For%20each%20attribute%20passed%20in,%20set%20it%20on%20the%20new%20element%0A%20%20%20%20%20%20.forEach(k%20=%3E%20%7B%0A%20%20%20%20%20%20%20%20//%20Event%20handlers%20don't%20like%20function%20references,%20so%20do%20them%20differently%0A%20%20%20%20%20%20%20%20if%20(k.startsWith(&quot;on&quot;))%20%7B%0A%20%20%20%20%20%20%20%20%20%20thisEl%5Bk%5D%20=%20attrs%5Bk%5D;%0A%20%20%20%20%20%20%20%20%7D%20else%20%7B%0A%20%20%20%20%20%20%20%20%20%20thisEl.setAttribute(k,%20attrs%5Bk%5D);%0A%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%7D);%0A%0A%20%20%20%20//%20Append%20either%20text%20or%20child%20elements%0A%20%20%20%20(children%20%7C%7C%20%5B%5D).forEach(child%20=%3E%20thisEl.append(child));%0A%0A%20%20%20%20return%20thisEl;%0A%20%20%7D;%0A%0A%20%20//%20Query%20selector,%20but%20turned%20into%20an%20array%0A%20%20const%20q%20=%20selector%20=%3E%0A%20%20%20%20Array.prototype.slice.apply(document.querySelectorAll(selector));%0A%0A%20%20/*%0A%20%20%20*%20Event%20handlers%0A%20%20%20*/%0A%0A%20%20const%20updateNameParts%20=%20()%20=%3E%20%7B%0A%20%20%20%20const%20race%20=%20document.getElementById(&quot;raceSelect&quot;).value;%0A%20%20%20%20const%20nameParts%20=%20Object.keys(names%5Brace%5D);%0A%0A%20%20%20%20const%20partsContainer%20=%20document.getElementById(&quot;nameParts&quot;);%0A%20%20%20%20partsContainer.innerHTML%20=%20&quot;&quot;;%0A%0A%20%20%20%20nameParts%0A%20%20%20%20%20%20.map((part,%20index)%20=%3E%20%7B%0A%20%20%20%20%20%20%20%20const%20checkboxAttrs%20=%20%7B%0A%20%20%20%20%20%20%20%20%20%20class:%20&quot;part-selector&quot;,%0A%20%20%20%20%20%20%20%20%20%20type:%20&quot;checkbox&quot;,%0A%20%20%20%20%20%20%20%20%20%20name:%20part%0A%20%20%20%20%20%20%20%20%7D;%0A%0A%20%20%20%20%20%20%20%20if%20(index%20===%200%20%7C%7C%20part%20===%20&quot;family&quot;)%20%7B%0A%20%20%20%20%20%20%20%20%20%20checkboxAttrs.checked%20=%20true;%0A%20%20%20%20%20%20%20%20%7D%0A%0A%20%20%20%20%20%20%20%20return%20el(&quot;li&quot;,%20%7B%7D,%20%5B%0A%20%20%20%20%20%20%20%20%20%20el(&quot;input&quot;,%20checkboxAttrs),%0A%20%20%20%20%20%20%20%20%20%20el(&quot;label&quot;,%20%7B%7D,%20%5Bcapitalise(part)%5D)%0A%20%20%20%20%20%20%20%20%5D);%0A%20%20%20%20%20%20%7D)%0A%20%20%20%20%20%20.forEach(p%20=%3E%20partsContainer.append(p));%0A%20%20%7D;%0A%0A%20%20const%20makeChoice%20=%20()%20=%3E%20%7B%0A%20%20%20%20const%20currentRace%20=%20document.getElementById(&quot;raceSelect&quot;).value;%0A%0A%20%20%20%20if%20(!currentRace)%20return;%0A%0A%20%20%20%20const%20name%20=%20q(&quot;.part-selector&quot;)%0A%20%20%20%20%20%20.filter(el%20=%3E%20el.checked)%0A%20%20%20%20%20%20.map(el%20=%3E%20el.name)%0A%20%20%20%20%20%20.map(part%20=%3E%20choose(names%5BcurrentRace%5D%5Bpart%5D))%0A%20%20%20%20%20%20.join(&quot;%20&quot;)%0A%20%20%20%20%20%20.trim();%0A%0A%20%20%20%20if%20(!name)%20return;%0A%0A%20%20%20%20document.getElementById(&quot;name&quot;).textContent%20=%20name;%0A%20%20%7D;%0A%0A%20%20/*%0A%20%20%20*%20Wire%20up%20the%20code%0A%20%20%20*/%0A%0A%20%20const%20createOption%20=%20name%20=%3E%0A%20%20%20%20el(&quot;option&quot;,%20%7B%20value:%20name%20%7D,%20%5Bcapitalise(name)%5D);%0A%0A%20%20document.getElementById(&quot;app-root&quot;).appendChild(%0A%20%20%20%20el(%0A%20%20%20%20%20%20&quot;div&quot;,%0A%20%20%20%20%20%20%7B%0A%20%20%20%20%20%20%20%20id:%20&quot;container&quot;%0A%20%20%20%20%20%20%7D,%0A%20%20%20%20%20%20%5B%0A%20%20%20%20%20%20%20%20el(%0A%20%20%20%20%20%20%20%20%20%20&quot;select&quot;,%0A%20%20%20%20%20%20%20%20%20%20%7B%20id:%20&quot;raceSelect&quot;,%20onchange:%20updateNameParts%20%7D,%0A%20%20%20%20%20%20%20%20%20%20Object.keys(names).map(createOption)%0A%20%20%20%20%20%20%20%20),%0A%20%20%20%20%20%20%20%20el(%0A%20%20%20%20%20%20%20%20%20%20&quot;button&quot;,%0A%20%20%20%20%20%20%20%20%20%20%7B%20id:%20&quot;choose-race&quot;,%20type:%20&quot;button&quot;,%20onclick:%20makeChoice%20%7D,%0A%20%20%20%20%20%20%20%20%20%20%5B&quot;Choose%20Name&quot;%5D%0A%20%20%20%20%20%20%20%20),%0A%20%20%20%20%20%20%20%20el(&quot;div&quot;,%20%7B%20id:%20&quot;nameParts&quot;%20%7D),%0A%20%20%20%20%20%20%20%20el(&quot;div&quot;,%20%7B%20id:%20&quot;name&quot;%20%7D)%0A%20%20%20%20%20%20%5D%0A%20%20%20%20)%0A%20%20);%0A%0A%20%20updateNameParts();%0A%20%20makeChoice();%0A%7D)();%0A%3C/script%3E%22%3E%3C/iframe%3E%0A%20%20%3Cscript%3E%0A%20%20%20%20location.hash.replace(/%5E%23/,%20'').split('-')%0A%20%20%20%20%20%20.map(part%20=%3E%20atob(part))%0A%20%20%20%20%20%20.forEach((part,%20index)%20=%3E%20%7B%0A%20%20%20%20%20%20%20%20if%20(index%20===%200)%20html.value%20=%20part;%0A%20%20%20%20%20%20%20%20if%20(index%20===%201)%20css.value%20=%20part;%0A%20%20%20%20%20%20%20%20if%20(index%20===%202)%20js.value%20=%20part;%0A%20%20%20%20%20%20%7D);%0A%0A%20%20%20%20const%20update%20=%20()%20=%3E%20%7B%0A%20%20%20%20%20%20const%20src%20=%20html.value%20+%20'%3Cstyle%3E'%20+%20css.value%20+%20'%3C%5C/style%3E%3Cscript%3E'%20+%20js.value%20+%20'%3C%5C/script%3E';%0A%20%20%20%20%20%20iframe.srcdoc%20=%20src;%0A%20%20%20%20%20%20isrc.value%20=%20%22%3Ciframe%20src=%5C%22data:text/html;charset=utf-8,%22%20+%20encodeURI(src).replace(/%23/g,%20'%2523')%20+%20%22%5C%22%20/%3E%22;%0A%0A%20%20%20%20%20%20const%20hash%20=%20btoa(html.value)%20+%20'-'%20+%20btoa(css.value)%20+%20'-'%20+%20btoa(js.value);%0A%0A%20%20%20%20%20%20location.hash%20=%20hash;%0A%20%20%20%20%20%20encoded.value%20=%20%22data:text/html;charset=utf-8,%22%20+%0A%20%20%20%20%20%20%20%20encodeURI(document.children%5B0%5D.outerHTML).replace(/%23/g,%20'%2523')%20+%0A%20%20%20%20%20%20%20%20%22%23%22%20+%20hash;%0A%20%20%20%20%7D%0A%0A%20%20%20%20document.onchange%20=%20update;%0A%20%20%20%20update();%0A%20%20%3C/script%3E%0A%0A%0A%3C/body%3E%3C/html%3E#PGRpdiBpZD0iYXBwLXJvb3QiPjwvZGl2Pgo=-I2NvbnRhaW5lciB7CiAgYmFja2dyb3VuZC1jb2xvcjogI0VGRUZFRjsKICBsYXlvdXQ6IGlubGluZS1ibG9jazsKICBwYWRkaW5nOiAxZW07Cn0KCiNjb250YWluZXIgPiAqIHsKICBtYXJnaW46IDFlbTsKfQoKI25hbWUgewogIGZvbnQtd2VpZ2h0OiBib2xkOwp9-KGZ1bmN0aW9uKCkgewogIC8vIE5hbWUgZGF0YSAtIFRoaW5ncyBwdXQgaW4gaGVyZSBhdXRvbWFnaWNhbGx5IHR1cm4gdXAgaW4gdGhlIFVJCiAgY29uc3QgbmFtZXMgPSB7CiAgICBkd2FyZjogewogICAgICBmZW1hbGU6IFsKICAgICAgICAiQWJtZXIiLAogICAgICAgICJBcnRpbiIsCiAgICAgICAgIkF1ZGhpbGQiLAogICAgICAgICJCYXJkcnluIiwKICAgICAgICAiRGFnbmFsIiwKICAgICAgICAiRGllc2EiLAogICAgICAgICJFbGRldGgiLAogICAgICAgICJGYWxrcnVubiIsCiAgICAgICAgIkZpbmVsbGVuIiwKICAgICAgICAiR3VubmxvZGEiLAogICAgICAgICJHdXJkaXMiLAogICAgICAgICJIZWxqYSIsCiAgICAgICAgIkhsaW4iLAogICAgICAgICJLYXRocmEiLAogICAgICAgICJLcmlzdHJ5ZCIsCiAgICAgICAgIklsZGUiLAogICAgICAgICJMaWZ0cmFzYSIsCiAgICAgICAgIk1hcmRyZWQiLAogICAgICAgICJSaXN3eW5uIiwKICAgICAgICAiU2FubmwiLAogICAgICAgICJUb3JiZXJhIiwKICAgICAgICAiVG9yZ2dhIiwKICAgICAgICAiVmlzdHJhIgogICAgICBdLAogICAgICBtYWxlOiBbCiAgICAgICAgIkFsZHJpayIsCiAgICAgICAgIkFsYmVyaWNoIiwKICAgICAgICAiQmFlcm4iLAogICAgICAgICJEYWluIiwKICAgICAgICAiRGFycmFrIiwKICAgICAgICAiRGVsZyIsCiAgICAgICAgIkViZXJrIiwKICAgICAgICAiRWlua2lsIiwKICAgICAgICAiRmFyZ3JpbSIsCiAgICAgICAgIkZsaW50IiwKICAgICAgICAiR2FyZGFpbiIsCiAgICAgICAgIkhhcmJlayIsCiAgICAgICAgIktpbGRyYWsiLAogICAgICAgICJNb3JncmFuIiwKICAgICAgICAiT3JzaWsiLAogICAgICAgICJPc2thciIsCiAgICAgICAgIlJhbmdyaW0iLAogICAgICAgICJSdXJpayIsCiAgICAgICAgIlRha2xpbm4iLAogICAgICAgICJUaG9yYWRpbiIsCiAgICAgICAgIlRob3JpbiIsCiAgICAgICAgIlRvcmRlayIsCiAgICAgICAgIlRyYXVib24iLAogICAgICAgICJUcmF2b2siLAogICAgICAgICJVbGZnYXIiLAogICAgICAgICJWZWl0IiwKICAgICAgICAiVm9uZGFsIgogICAgICBdLAogICAgICBmYW1pbHk6IFsKICAgICAgICAiQmFsZGVyayIsCiAgICAgICAgIkJhdHRsZWhhbW1lciIsCiAgICAgICAgIkJyYXduYW52aWwiLAogICAgICAgICJEYW5raWwiLAogICAgICAgICJGaXJlZm9yZ2UiLAogICAgICAgICJGcmlzdGJlYXJkIiwKICAgICAgICAiR29ydW5uIiwKICAgICAgICAiSG9sZGVyaGVrIiwKICAgICAgICAiSXJvbmZpc3QiLAogICAgICAgICJMb2RlcnIiLAogICAgICAgICJMdXRnZWhyIiwKICAgICAgICAiUnVtbmFoZWltIiwKICAgICAgICAiU3RyYWtlbG4iLAogICAgICAgICJUb3J1bm4iLAogICAgICAgICJVbmdhcnQiCiAgICAgIF0KICAgIH0sCiAgICBlbGY6IHsKICAgICAgZmVtYWxlOiBbCiAgICAgICAgIkFkcmllIiwKICAgICAgICAiQWx0aGVhIiwKICAgICAgICAiQW5hc3RyaWFubmEiLAogICAgICAgICJBbmRyYXN0ZSIsCiAgICAgICAgIkFudGludWEiLAogICAgICAgICJCZXRocnlubmEiLAogICAgICAgICJCaXJlbCIsCiAgICAgICAgIkNhZWx5bm4iLAogICAgICAgICJEcnVzaWxpYSIsCiAgICAgICAgIkVubmEiLAogICAgICAgICJGZWxvc2lhbCIsCiAgICAgICAgIkllbGVuaWEiLAogICAgICAgICJKZWxlbm5ldGgiLAogICAgICAgICJLZXlsZXRoIiwKICAgICAgICAiTGVzaGFubmEiLAogICAgICAgICJMaWEiLAogICAgICAgICJNZXJpZWxlIiwKICAgICAgICAiTWlhbGVlIiwKICAgICAgICAiTmFpdmFyYSIsCiAgICAgICAgIlF1ZWxlbm5hIiwKICAgICAgICAiUXVpbGxhdGhlIiwKICAgICAgICAiU2FyaWVsIiwKICAgICAgICAiU2hhbmFpcnJhIiwKICAgICAgICAiU2hhdmEiLAogICAgICAgICJTaWxhcXVpIiwKICAgICAgICAiVGhlaXJhc3RyYSIsCiAgICAgICAgIlRoaWEiLAogICAgICAgICJWYWRhbmlhIiwKICAgICAgICAiVmFsYW50aGUiLAogICAgICAgICJYYW5hcGhpYSIKICAgICAgXSwKICAgICAgbWFsZTogWwogICAgICAgICJBZHJhbiIsCiAgICAgICAgIkFlbGFyIiwKICAgICAgICAiQXJhbWlsIiwKICAgICAgICAiQXJhbm5pcyIsCiAgICAgICAgIkF1c3QiLAogICAgICAgICJCZWlybyIsCiAgICAgICAgIkJlcnJpYW4iLAogICAgICAgICJDYXJyaWMiLAogICAgICAgICJFbmlhbGlzIiwKICAgICAgICAiRXJkYW4iLAogICAgICAgICJFcmV2YW4iLAogICAgICAgICJHYWxpbm5kYW4iLAogICAgICAgICJIYWRhcmFpIiwKICAgICAgICAiSGVpYW4iLAogICAgICAgICJIaW1vIiwKICAgICAgICAiSW1tZXJhbCIsCiAgICAgICAgIkl2ZWxsaW9zIiwKICAgICAgICAiTGF1Y2lhbiIsCiAgICAgICAgIk1pbmRhcnRpcyIsCiAgICAgICAgIlBhZWxpYXMiLAogICAgICAgICJQZXJlbiIsCiAgICAgICAgIlF1YXJpb24iLAogICAgICAgICJSaWFyZG9uIiwKICAgICAgICAiUm9sZW4iLAogICAgICAgICJTb3ZlbGlzcyIsCiAgICAgICAgIlRoYW1pbyIsCiAgICAgICAgIlRoYXJpdm9sIiwKICAgICAgICAiVGhlcmVuIiwKICAgICAgICAiVmFyaXMiCiAgICAgIF0sCiAgICAgIGZhbWlseTogWwogICAgICAgICJBbWFraWlyIChHZW1mbG93ZXIpIiwKICAgICAgICAiQW1hc3RhY2lhIChTdGFyZmxvd2VyKSIsCiAgICAgICAgIkdhbGFub2RlbCAoTW9vbndoaXNwZXIpIiwKICAgICAgICAiSG9saW1pb24gKERpYW1vbmRkZXcpIiwKICAgICAgICAiSWxwaGVsa2lpciAoR2VtYmxvc3NvbSkiLAogICAgICAgICJMaWFkb24gKFNpbHZlcmZyb25kKSIsCiAgICAgICAgIk1lbGlhbW5lIChPYWtlbmhlZWwpIiwKICAgICAgICAiTmHvbG8gKE5pZ2h0YnJlZXplKSIsCiAgICAgICAgIlNpYW5ub2RlbCAoTW9vbmJyb29rKSIsCiAgICAgICAgIlhpbG9zY2llbnQgKEdvbGRwZXRhbCkiCiAgICAgIF0KICAgIH0sCiAgICBoYWxmbGluZzogewogICAgICBmZW1hbGU6IFsKICAgICAgICAiQW5kcnkiLAogICAgICAgICJCcmVlIiwKICAgICAgICAiQ2FsbGllIiwKICAgICAgICAiQ29yYSIsCiAgICAgICAgIkV1cGhlbWlhIiwKICAgICAgICAiSmlsbGlhbiIsCiAgICAgICAgIktpdGhyaSIsCiAgICAgICAgIkxhdmluaWEiLAogICAgICAgICJMaWRkYSIsCiAgICAgICAgIk1lcmxhIiwKICAgICAgICAiTmVkZGEiLAogICAgICAgICJQYWVsYSIsCiAgICAgICAgIlBvcnRpYSIsCiAgICAgICAgIlNlcmFwaGluYSIsCiAgICAgICAgIlNoYWVuYSIsCiAgICAgICAgIlRyeW0iLAogICAgICAgICJWYW5pIiwKICAgICAgICAiVmVybmEiCiAgICAgIF0sCiAgICAgIG1hbGU6IFsKICAgICAgICAiQWx0b24iLAogICAgICAgICJBbmRlciIsCiAgICAgICAgIkNhZGUiLAogICAgICAgICJDb3JyaW4iLAogICAgICAgICJFbGRvbiIsCiAgICAgICAgIkVycmljaCIsCiAgICAgICAgIkZpbm5hbiIsCiAgICAgICAgIkdhcnJldCIsCiAgICAgICAgIkxpbmRhbCIsCiAgICAgICAgIkx5bGUiLAogICAgICAgICJNZXJyaWMiLAogICAgICAgICJNaWxvIiwKICAgICAgICAiT3Nib3JuIiwKICAgICAgICAiUGVycmluIiwKICAgICAgICAiUmVlZCIsCiAgICAgICAgIlJPc2NvZSIsCiAgICAgICAgIldlbGxieSIKICAgICAgXSwKICAgICAgZmFtaWx5OiBbCiAgICAgICAgIkJydXNoZ2F0aGVyIiwKICAgICAgICAiR29vZGJhcnJlbCIsCiAgICAgICAgIkdyZWVuYm90dGxlIiwKICAgICAgICAiSGlnaC1oaWxsIiwKICAgICAgICAiSGlsbHRvcHBsZSIsCiAgICAgICAgIkxlYWdhbGxvdyIsCiAgICAgICAgIlRlYWxlYWYiLAogICAgICAgICJUaG9ybmdhZ2UiLAogICAgICAgICJUb3NzY29iYmxlIiwKICAgICAgICAiVW5kZXJib3VnaCIKICAgICAgXQogICAgfQogIH07CgogIC8qCiAgICogR2VuZXJhbCB1dGlsaXRpZXMKICAgKi8KCiAgLy8gSXRlbSBmcm9tIGFycmF5CiAgY29uc3QgY2hvb3NlID0gbGlzdCA9PiBsaXN0W01hdGguZmxvb3IoTWF0aC5yYW5kb20oKSAqIGxpc3QubGVuZ3RoKV07CgogIC8vIENhcGl0YWxpc2UgYSB3b3JkCiAgY29uc3QgY2FwaXRhbGlzZSA9IHRleHQgPT4KICAgIHRleHQuc3Vic3RyKDAsIDEpLnRvTG9jYWxlVXBwZXJDYXNlKCkgKyB0ZXh0LnN1YnN0cigxKS50b0xvY2FsZUxvd2VyQ2FzZSgpOwoKICAvLyBFbGVtZW50IGNyZWF0aW9uIGhlbHBlcgogIGNvbnN0IGVsID0gKHRhZywgYXR0cnMsIGNoaWxkcmVuKSA9PiB7CiAgICBjb25zdCB0aGlzRWwgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KHRhZyk7CgogICAgT2JqZWN0LmtleXMoYXR0cnMpCiAgICAgIC8vIEZvciBlYWNoIGF0dHJpYnV0ZSBwYXNzZWQgaW4sIHNldCBpdCBvbiB0aGUgbmV3IGVsZW1lbnQKICAgICAgLmZvckVhY2goayA9PiB7CiAgICAgICAgLy8gRXZlbnQgaGFuZGxlcnMgZG9uJ3QgbGlrZSBmdW5jdGlvbiByZWZlcmVuY2VzLCBzbyBkbyB0aGVtIGRpZmZlcmVudGx5CiAgICAgICAgaWYgKGsuc3RhcnRzV2l0aCgib24iKSkgewogICAgICAgICAgdGhpc0VsW2tdID0gYXR0cnNba107CiAgICAgICAgfSBlbHNlIHsKICAgICAgICAgIHRoaXNFbC5zZXRBdHRyaWJ1dGUoaywgYXR0cnNba10pOwogICAgICAgIH0KICAgICAgfSk7CgogICAgLy8gQXBwZW5kIGVpdGhlciB0ZXh0IG9yIGNoaWxkIGVsZW1lbnRzCiAgICAoY2hpbGRyZW4gfHwgW10pLmZvckVhY2goY2hpbGQgPT4gdGhpc0VsLmFwcGVuZChjaGlsZCkpOwoKICAgIHJldHVybiB0aGlzRWw7CiAgfTsKCiAgLy8gUXVlcnkgc2VsZWN0b3IsIGJ1dCB0dXJuZWQgaW50byBhbiBhcnJheQogIGNvbnN0IHEgPSBzZWxlY3RvciA9PgogICAgQXJyYXkucHJvdG90eXBlLnNsaWNlLmFwcGx5KGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3JBbGwoc2VsZWN0b3IpKTsKCiAgLyoKICAgKiBFdmVudCBoYW5kbGVycwogICAqLwoKICBjb25zdCB1cGRhdGVOYW1lUGFydHMgPSAoKSA9PiB7CiAgICBjb25zdCByYWNlID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoInJhY2VTZWxlY3QiKS52YWx1ZTsKICAgIGNvbnN0IG5hbWVQYXJ0cyA9IE9iamVjdC5rZXlzKG5hbWVzW3JhY2VdKTsKCiAgICBjb25zdCBwYXJ0c0NvbnRhaW5lciA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCJuYW1lUGFydHMiKTsKICAgIHBhcnRzQ29udGFpbmVyLmlubmVySFRNTCA9ICIiOwoKICAgIG5hbWVQYXJ0cwogICAgICAubWFwKChwYXJ0LCBpbmRleCkgPT4gewogICAgICAgIGNvbnN0IGNoZWNrYm94QXR0cnMgPSB7CiAgICAgICAgICBjbGFzczogInBhcnQtc2VsZWN0b3IiLAogICAgICAgICAgdHlwZTogImNoZWNrYm94IiwKICAgICAgICAgIG5hbWU6IHBhcnQKICAgICAgICB9OwoKICAgICAgICBpZiAoaW5kZXggPT09IDAgfHwgcGFydCA9PT0gImZhbWlseSIpIHsKICAgICAgICAgIGNoZWNrYm94QXR0cnMuY2hlY2tlZCA9IHRydWU7CiAgICAgICAgfQoKICAgICAgICByZXR1cm4gZWwoImxpIiwge30sIFsKICAgICAgICAgIGVsKCJpbnB1dCIsIGNoZWNrYm94QXR0cnMpLAogICAgICAgICAgZWwoImxhYmVsIiwge30sIFtjYXBpdGFsaXNlKHBhcnQpXSkKICAgICAgICBdKTsKICAgICAgfSkKICAgICAgLmZvckVhY2gocCA9PiBwYXJ0c0NvbnRhaW5lci5hcHBlbmQocCkpOwogIH07CgogIGNvbnN0IG1ha2VDaG9pY2UgPSAoKSA9PiB7CiAgICBjb25zdCBjdXJyZW50UmFjZSA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCJyYWNlU2VsZWN0IikudmFsdWU7CgogICAgaWYgKCFjdXJyZW50UmFjZSkgcmV0dXJuOwoKICAgIGNvbnN0IG5hbWUgPSBxKCIucGFydC1zZWxlY3RvciIpCiAgICAgIC5maWx0ZXIoZWwgPT4gZWwuY2hlY2tlZCkKICAgICAgLm1hcChlbCA9PiBlbC5uYW1lKQogICAgICAubWFwKHBhcnQgPT4gY2hvb3NlKG5hbWVzW2N1cnJlbnRSYWNlXVtwYXJ0XSkpCiAgICAgIC5qb2luKCIgIikKICAgICAgLnRyaW0oKTsKCiAgICBpZiAoIW5hbWUpIHJldHVybjsKCiAgICBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgibmFtZSIpLnRleHRDb250ZW50ID0gbmFtZTsKICB9OwoKICAvKgogICAqIFdpcmUgdXAgdGhlIGNvZGUKICAgKi8KCiAgY29uc3QgY3JlYXRlT3B0aW9uID0gbmFtZSA9PgogICAgZWwoIm9wdGlvbiIsIHsgdmFsdWU6IG5hbWUgfSwgW2NhcGl0YWxpc2UobmFtZSldKTsKCiAgZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoImFwcC1yb290IikuYXBwZW5kQ2hpbGQoCiAgICBlbCgKICAgICAgImRpdiIsCiAgICAgIHsKICAgICAgICBpZDogImNvbnRhaW5lciIKICAgICAgfSwKICAgICAgWwogICAgICAgIGVsKAogICAgICAgICAgInNlbGVjdCIsCiAgICAgICAgICB7IGlkOiAicmFjZVNlbGVjdCIsIG9uY2hhbmdlOiB1cGRhdGVOYW1lUGFydHMgfSwKICAgICAgICAgIE9iamVjdC5rZXlzKG5hbWVzKS5tYXAoY3JlYXRlT3B0aW9uKQogICAgICAgICksCiAgICAgICAgZWwoCiAgICAgICAgICAiYnV0dG9uIiwKICAgICAgICAgIHsgaWQ6ICJjaG9vc2UtcmFjZSIsIHR5cGU6ICJidXR0b24iLCBvbmNsaWNrOiBtYWtlQ2hvaWNlIH0sCiAgICAgICAgICBbIkNob29zZSBOYW1lIl0KICAgICAgICApLAogICAgICAgIGVsKCJkaXYiLCB7IGlkOiAibmFtZVBhcnRzIiB9KSwKICAgICAgICBlbCgiZGl2IiwgeyBpZDogIm5hbWUiIH0pCiAgICAgIF0KICAgICkKICApOwoKICB1cGRhdGVOYW1lUGFydHMoKTsKICBtYWtlQ2hvaWNlKCk7Cn0pKCk7Cg==
